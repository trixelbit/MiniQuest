(()=>{"use strict";var e={177:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerMovement=void 0;const i=s(38),o=s(603);class n extends i.Component{get Velocity(){return this._velocity.Copy()}constructor(e,t,s,i){super(e),this._velocity=o.Vector2.Zero(),this._input=o.Vector2.Zero(),this.DRAG_COEFFICIENT=.05,this._inputSystem=s,this._maxSpeed=i,console.log("constructor world pos "+e.WorldPosition.x)}Update(){this._input=this.ProcessInput(),console.log("in"+this._input.x),this._velocity=o.Vector2.Scale(this._input,this._maxSpeed),console.log("vel"+this._velocity.x),this._velocity=o.Vector2.Lerp(this._velocity,o.Vector2.Zero(),this.DRAG_COEFFICIENT),console.log("vel"+this._velocity.x);const e=this.Entity.WorldPosition.x+this._velocity.x,t=this.Entity.WorldPosition.y+this._velocity.y;this.Entity.WorldPosition=new o.Vector2(e,t),console.log("Update"+this.Entity.WorldPosition)}ProcessInput(){var e=0,t=0;return this._inputSystem.IsKeyDown("a")&&(e-=1),this._inputSystem.IsKeyDown("d")&&(e+=1),this._inputSystem.IsKeyDown("w")&&(t-=1),this._inputSystem.IsKeyDown("s")&&(t+=1),o.Vector2.Normalized(new o.Vector2(e,t))}}t.PlayerMovement=n},38:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=t.Component=void 0;const i=s(603);t.Component=class{constructor(e){this.Entity=e}Start(){}Update(){}},t.Entity=class{constructor(e,t=i.Vector2.Zero()){this._id=crypto.randomUUID(),this.WorldPosition=t,this._element=document.createElement("img"),this._element.style.position="absolute",this._element.style.scale="200%",this._element.style.imageRendering="pixelated",this._element.id=e+" - "+this._id,this._element.src="",this._element.style.zIndex="10",document.body.appendChild(this._element),this._components=[]}AddComponent(e){this._components.push(e)}Start(){for(const e of this._components)e.Start()}Update(){for(const e of this._components)e.Update()}ApplyCameraPositionToElement(e){isNaN(e.x)&&console.log("cam pos is nan"),isNaN(this.WorldPosition.x)&&console.log("world pos is nan"),console.log("Pre"+this.WorldPosition.x);const t=i.Vector2.Subtract(this.WorldPosition,e);console.log("Post"+this.WorldPosition.x),this._element.style.top=t.y+"px",this._element.style.left=t.x+"px"}}},983:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const i=s(177),o=s(38);class n extends o.Entity{constructor(e){super("Player"),this._state=r.Idle,this._direction=l.Down,this._spriteTable=["Images/idle_up.png","Images/idle_down.png","Images/idle_left.png","Images/idle_right.png","Images/run_up.gif","Images/run_down.gif","Images/run_left.gif","Images/run_right.gif"],this._element.src="Images/idle_up.png",this._movement=new i.PlayerMovement(this,this._element,e,4),this.AddComponent(this._movement)}Update(){super.Update(),this.UpdateSpriteState()}UpdateSpriteState(){var e=this._movement.Velocity;e.Magnitude()>0?this._state=r.Walking:this._state=r.Idle,e.x>0?this._direction=l.Right:e.x<0&&(this._direction=l.Left),e.y>0?this._direction=l.Down:e.y<0&&(this._direction=l.Up);var t=4*this._state+this._direction;this.SetSprite(this._spriteTable[t])}SetSprite(e){this._element.getAttribute("src")!==e&&this._element.setAttribute("src",e)}}var r,l;t.Player=n,function(e){e[e.Idle=0]="Idle",e[e.Walking=1]="Walking"}(r||(r={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(l||(l={}))},154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputSystem=void 0,t.InputSystem=class{constructor(){this._downKeys=new Map,this._pressedKeys=new Map,this._releasedKeys=new Map,document.addEventListener("DOMContentLoaded",(()=>{document.addEventListener("keydown",(e=>{this._downKeys.set(e.key,!0),this._pressedKeys.set(e.key,!0),this._releasedKeys.set(e.key,!1)})),document.addEventListener("keyup",(e=>{this._downKeys.set(e.key,!1),this._pressedKeys.set(e.key,!1),this._releasedKeys.set(e.key,!0)}))}))}IsKeyDown(e){if(!this._downKeys.has(e))return!1;const t=this._downKeys.get(e);return void 0!==t&&t}IsKeyPressed(e){if(!this._pressedKeys.has(e))return!1;const t=this._pressedKeys.get(e);return void 0!==t&&t}IsKeyReleased(e){if(!this._releasedKeys.has(e))return!1;const t=this._releasedKeys.get(e);return void 0!==t&&t}ResetReleasedKeys(){for(var e in this._releasedKeys)this._releasedKeys.set(e,!1)}}},912:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0,t.MathUtils=class{static Lerp(e,t,s){return e+(t-e)*s}}},603:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector2=void 0;const i=s(912);class o{constructor(e,t){this.x=e,this.y=t}Copy(){return new o(this.x,this.y)}static Scale(e,t){return new o(e.x*t,e.y*t)}Scale(e){this.x*=e,this.y*=e}static Subtract(e,t){if(null===e)throw new Error("a in Vector2.Subtract is null");if(null===t)throw new Error("b in Vector2.Subtract is null");return new o(e.x-t.x,e.y-t.y)}Magnitude(){return o.Distance(o.Zero(),this)}static Distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static Lerp(e,t,s){return new o(i.MathUtils.Lerp(e.x,t.x,s),i.MathUtils.Lerp(e.y,t.y,s))}static Zero(){return new o(0,0)}static Normalized(e){var t=e.Magnitude();return 0===t?o.Zero():new o(e.x/t,e.y/t)}}t.Vector2=o},607:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(o,n){function r(e){try{a(i.next(e))}catch(e){n(e)}}function l(e){try{a(i.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,l)}a((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=s(154),n=s(983),r=s(603),l=new o.InputSystem;document.addEventListener("DOMContentLoaded",(()=>{const e=new n.Player(l);for(var t=0;t<1e3;t+=64)for(var s=0;s<1e3;s+=64){const e=document.createElement("img");e.style.position,e.style.position="absolute",e.style.scale="200%",e.style.imageRendering="pixelated",e.src="Images/grass.png",e.style.zIndex="0",e.style.left=t.toString()+"px",e.style.top=s.toString()+"px",e.style.scale="2",document.body.appendChild(e)}!function(e,t){i(this,void 0,void 0,(function*(){for(var s=r.Vector2.Zero();;)e.Start(),yield new Promise((e=>setTimeout(e,10))),e.Update(),t.IsKeyDown("h")&&(s.x+=-1),t.IsKeyDown("l")&&(s.x+=1),t.IsKeyDown("j")&&(s.y+=1),t.IsKeyDown("k")&&(s.y+=-1),e.ApplyCameraPositionToElement(s),t.ResetReleasedKeys()}))}(e,l)}))}},t={};!function s(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}(607)})();