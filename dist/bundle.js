(()=>{"use strict";var e={177:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerMovement=void 0;const i=s(38),n=s(603);class o extends i.Component{get Velocity(){return this._velocity.Copy()}constructor(e,t,s){super(e),this._velocity=n.Vector2.Zero(),this._input=n.Vector2.Zero(),this.DRAG_COEFFICIENT=.05,this._inputSystem=t,this._maxSpeed=s}Update(){this._input=this.ProcessInput(),this._velocity=n.Vector2.Scale(this._input,this._maxSpeed),this._velocity=n.Vector2.Lerp(this._velocity,n.Vector2.Zero(),this.DRAG_COEFFICIENT);const e=this.Entity.WorldPosition.x+this._velocity.x,t=this.Entity.WorldPosition.y+this._velocity.y;this.Entity.WorldPosition=new n.Vector2(e,t)}ProcessInput(){var e=0,t=0;return this._inputSystem.IsKeyDown("a")&&(e-=1),this._inputSystem.IsKeyDown("d")&&(e+=1),this._inputSystem.IsKeyDown("w")&&(t-=1),this._inputSystem.IsKeyDown("s")&&(t+=1),n.Vector2.Normalized(new n.Vector2(e,t))}}t.PlayerMovement=o},38:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=t.Component=void 0;const i=s(603);t.Component=class{constructor(e){this.Entity=e}Start(){}Update(){}},t.Entity=class{constructor(e,t=i.Vector2.Zero()){this._id=crypto.randomUUID(),this.WorldPosition=t,this._element=document.createElement("img"),this._element.style.position="absolute",this._element.style.scale="200%",this._element.style.imageRendering="pixelated",this._element.id=e+" - "+this._id,this._element.src="",this._element.style.zIndex="10",document.body.appendChild(this._element),this._components=[]}SetZDepth(e){this._element.style.zIndex=e.toString()}AddComponent(e){this._components.push(e)}Start(){for(const e of this._components)e.Start()}Update(){for(const e of this._components)e.Update()}SetSprite(e){this._element.getAttribute("src")!==e&&this._element.setAttribute("src",e)}ApplyCameraPositionToElement(e){const t=i.Vector2.Subtract(this.WorldPosition,e);this._element.style.top=t.y+"px",this._element.style.left=t.x+"px"}}},983:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const i=s(177),n=s(38);class o extends n.Entity{constructor(e){super("Player"),this._state=r.Idle,this._direction=a.Down,this._spriteTable=["Images/idle_up.png","Images/idle_down.png","Images/idle_left.png","Images/idle_right.png","Images/run_up.gif","Images/run_down.gif","Images/run_left.gif","Images/run_right.gif"],this._element.src="Images/idle_up.png",this._movement=new i.PlayerMovement(this,e,4),this.AddComponent(this._movement)}Update(){super.Update(),this.UpdateSpriteState()}UpdateSpriteState(){var e=this._movement.Velocity;e.Magnitude()>0?this._state=r.Walking:this._state=r.Idle,e.x>0?this._direction=a.Right:e.x<0&&(this._direction=a.Left),e.y>0?this._direction=a.Down:e.y<0&&(this._direction=a.Up);var t=4*this._state+this._direction;this.SetSprite(this._spriteTable[t])}}var r,a;t.Player=o,function(e){e[e.Idle=0]="Idle",e[e.Walking=1]="Walking"}(r||(r={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(a||(a={}))},154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputSystem=void 0,t.InputSystem=class{constructor(){this._downKeys=new Map,this._pressedKeys=new Map,this._releasedKeys=new Map,document.addEventListener("DOMContentLoaded",(()=>{document.addEventListener("keydown",(e=>{this._downKeys.set(e.key,!0),this._pressedKeys.set(e.key,!0),this._releasedKeys.set(e.key,!1)})),document.addEventListener("keyup",(e=>{this._downKeys.set(e.key,!1),this._pressedKeys.set(e.key,!1),this._releasedKeys.set(e.key,!0)}))}))}IsKeyDown(e){if(!this._downKeys.has(e))return!1;const t=this._downKeys.get(e);return void 0!==t&&t}IsKeyPressed(e){if(!this._pressedKeys.has(e))return!1;const t=this._pressedKeys.get(e);return void 0!==t&&t}IsKeyReleased(e){if(!this._releasedKeys.has(e))return!1;const t=this._releasedKeys.get(e);return void 0!==t&&t}ResetReleasedKeys(){for(var e in this._releasedKeys)this._releasedKeys.set(e,!1)}}},912:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0,t.MathUtils=class{static Lerp(e,t,s){return e+(t-e)*s}}},603:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector2=void 0;const i=s(912);class n{constructor(e,t){this.x=e,this.y=t}Copy(){return new n(this.x,this.y)}static Scale(e,t){return new n(e.x*t,e.y*t)}Scale(e){this.x*=e,this.y*=e}static Subtract(e,t){if(null===e)throw new Error("a in Vector2.Subtract is null");if(null===t)throw new Error("b in Vector2.Subtract is null");return new n(e.x-t.x,e.y-t.y)}Magnitude(){return n.Distance(n.Zero(),this)}static Distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static Lerp(e,t,s){return new n(i.MathUtils.Lerp(e.x,t.x,s),i.MathUtils.Lerp(e.y,t.y,s))}static Zero(){return new n(0,0)}static Normalized(e){var t=e.Magnitude();return 0===t?n.Zero():new n(e.x/t,e.y/t)}}t.Vector2=n},607:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=s(154),o=s(983),r=s(603),a=s(38),c=new n.InputSystem;var d=[];document.addEventListener("DOMContentLoaded",(()=>{const e=new o.Player(c);d.push(e);for(var t=0;t<1e3;t+=64)for(var s=0;s<1e3;s+=64){var n=new a.Entity("Tile",new r.Vector2(t,s));n.SetSprite("Images/grass.png"),n.SetZDepth(0),d.push(n)}!function(e,t){i(this,void 0,void 0,(function*(){var s=r.Vector2.Zero();for(const t of e)t.Start();for(;;){yield new Promise((e=>setTimeout(e,10)));for(const t of e)t.Update();t.IsKeyDown("h")&&(s.x+=-3),t.IsKeyDown("l")&&(s.x+=3),t.IsKeyDown("j")&&(s.y+=3),t.IsKeyDown("k")&&(s.y+=-3);for(const t of e)t.ApplyCameraPositionToElement(s);t.ResetReleasedKeys()}}))}(d,c)}))}},t={};!function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}(607)})();